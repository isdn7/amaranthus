import streamlit as st
import pandas as pd

# í˜ì´ì§€ ê¸°ë³¸ ì„¤ì •
st.set_page_config(page_title="ê³¼ëª© ìœ í˜• ê²€ì‚¬", page_icon="ğŸ“š", layout="centered")

# @st.cache_data -> ìºì‹œ ê¸°ëŠ¥ì„ ì ì‹œ ë¹„í™œì„±í™”í•˜ì—¬ ì›ì¸ ë¶„ì„
def load_data(file_path):
    """ì—‘ì…€ íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜"""
    try:
        df = pd.read_excel(file_path)
        return df
    except FileNotFoundError:
        st.error(f"'{file_path}' íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        return None
    except Exception as e:
        st.error(f"ë°ì´í„°ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}")
        return None

# ë°ì´í„° ë¡œë“œ
df = load_data('data.xlsx')

# í•„ìˆ˜ ì»¬ëŸ¼ëª… ì •ì˜
required_columns = ['ë²ˆí˜¸', 'ìˆ˜ì •ë‚´ìš©', 'ì²™ë„', 'ì¹´í…Œê³ ë¦¬', 'ê´€ë ¨êµê³¼êµ°']

# ==================================================================
# â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼ ì •ë°€ ë””ë²„ê¹… ì½”ë“œ â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼â–¼
if df is not None:
    st.error("--- ì •ë°€ ë””ë²„ê¹… ëª¨ë“œ ---")
    
    st.write("**ì½”ë“œì—ì„œ ìš”êµ¬í•˜ëŠ” ì»¬ëŸ¼ëª…:**")
    st.write(required_columns)
    
    actual_cols = list(df.columns)
    st.write("**ì—‘ì…€ì—ì„œ ì‹¤ì œë¡œ ì½ì–´ì˜¨ ì»¬ëŸ¼ëª…:**")
    st.write(actual_cols)
    
    st.write("**â–¼ ê° ì»¬ëŸ¼ ì¼ì¹˜ ì—¬ë¶€ ìƒì„¸ ë¹„êµ â–¼**")
    for req_col in required_columns:
        # ì‹¤ì œ ì»¬ëŸ¼ ë¦¬ìŠ¤íŠ¸ì™€ íƒ€ì…ì„ ë¹„êµí•˜ì—¬ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸
        is_present = req_col in actual_cols
        st.info(f"ì½”ë“œì˜ '{req_col}' (íƒ€ì…: str)ì´(ê°€) ì—‘ì…€ì— ìˆìŠµë‹ˆê¹Œ?  ğŸ‘‰  **{is_present}**")

    st.error("--- ë””ë²„ê¹… ì¢…ë£Œ ---")
# â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–² ì •ë°€ ë””ë²„ê¹… ì½”ë“œ â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²â–²
# ==================================================================

# ë°ì´í„° ë˜ëŠ” í•„ìˆ˜ ì»¬ëŸ¼ì´ ì—†ëŠ” ê²½ìš° ì•± ì‹¤í–‰ ì¤‘ì§€
if df is None or not all(col in df.columns for col in required_columns):
    st.error("ì˜¤ë¥˜: ìœ„ ë””ë²„ê¹… ê²°ê³¼ë¥¼ í™•ì¸í•˜ì—¬, Falseë¡œ ë‚˜ì˜¨ ì»¬ëŸ¼ì˜ ì´ë¦„ ë˜ëŠ” íƒ€ì…ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
    st.stop()

# --- ì´í•˜ ì½”ë“œëŠ” ë™ì¼ ---
st.title("ğŸ“š ë‚˜ì˜ ê³¼ëª© ì„ í˜¸ ìœ í˜• ê²€ì‚¬")
# (ì´í•˜ ë‚˜ë¨¸ì§€ ì½”ë“œëŠ” ìƒëµ, ì´ì „ ì½”ë“œì™€ ë™ì¼í•˜ê²Œ ìœ ì§€)
# ...
